<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Danh s√°ch kh√°ch h√†ng</title>
  <link rel="stylesheet" th:href="@{/style.css}">
  <script>
    function toggleFormAdd() {
      var form = document.getElementById("addCustomerForm");
      form.style.display = (form.style.display === "none") ? "block" : "none";
    }

    function toggleFormEdit(id, name, phone, address, debtBalance) {
      var form = document.getElementById("editCustomerForm");
      form.style.display = "block";

      document.getElementById("editId").value = id;
      document.getElementById("editName").value = name;
      document.getElementById("editPhone").value = phone;
      document.getElementById("editAddress").value = address;
      document.getElementById("editDebtBalance").value = debtBalance;
    }

    function closeEditForm() {
      document.getElementById("editCustomerForm").style.display = "none";
    }
  </script>
</head>
<body>
<!-- Thanh t√¨m ki·∫øm -->
<div class="search-container">
  <form th:action="@{/customers/search}" method="get">
    <input type="text" name="keyword" placeholder="Nh·∫≠p t√™n ho·∫∑c s·ªë ƒëi·ªán tho·∫°i..." th:value="${keyword}">
    <button type="submit">üîç T√¨m ki·∫øm</button>
  </form>
</div>


<div class="container">
  <h2>Danh s√°ch kh√°ch h√†ng</h2>

  <!-- Hi·ªÉn th·ªã th√¥ng b√°o n·∫øu c√≥ -->
  <div th:if="${message}" class="alert">
    <p th:text="${message}"></p>
  </div>

  <!-- N√∫t m·ªü form th√™m kh√°ch h√†ng -->
  <div class="add-button">
    <button class="btn-add" onclick="toggleFormAdd()">‚ûï Th√™m kh√°ch h√†ng</button>
  </div>

  <!-- Form th√™m kh√°ch h√†ng (·∫®n ban ƒë·∫ßu) -->
  <div id="addCustomerForm" style="display: none;">
    <h3>Th√™m kh√°ch h√†ng m·ªõi</h3>
    <form th:action="@{/customers/add}" th:object="${customer}" method="post">
      <label for="name">T√™n kh√°ch h√†ng:</label>
      <input type="text" id="name" th:field="*{name}" required>

      <label for="phone">S·ªë ƒëi·ªán tho·∫°i:</label>
      <input type="text" id="phone" th:field="*{phone}" required>

      <label for="address">ƒê·ªãa ch·ªâ:</label>
      <input type="text" id="address" th:field="*{address}" required>

      <label for="debtBalance">C√¥ng n·ª£:</label>
      <input type="number" id="debtBalance" th:field="*{debtBalance}" step="0.01" required>

      <button type="submit" class="btn">Th√™m kh√°ch h√†ng</button>
      <button type="button" class="btn cancel" onclick="toggleFormAdd()">H·ªßy</button>
    </form>
  </div>

  <!-- B·∫£ng danh s√°ch kh√°ch h√†ng -->
  <table>
    <thead>
    <tr>
      <th>ID</th>
      <th>T√™n kh√°ch h√†ng</th>
      <th>S·ªë ƒëi·ªán tho·∫°i</th>
      <th>ƒê·ªãa ch·ªâ</th>
      <th>C√¥ng n·ª£</th>
      <th>H√†nh ƒë·ªông</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="customer : ${customers}">
      <td th:text="${customer?.id}"></td>
      <td th:text="${customer?.name}"></td>
      <td th:text="${customer?.phone}"></td>
      <td th:text="${customer?.address}"></td>
      <td th:text="${customer?.debtBalance}"></td>
      <td class="action-links">
        <button class="edit"
                th:attr="onclick=|toggleFormEdit('${customer.id}', '${customer.name}', '${customer.phone}', '${customer.address}', '${customer.debtBalance}')|">
          S·ª≠a
        </button>
        <a th:href="@{/customers/delete/{id}(id=${customer.id})}" class="delete"
           onclick="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a kh√°ch h√†ng n√†y?')">X√≥a</a>
      </td>
    </tr>
    </tbody>
  </table>

  <!-- Form ch·ªânh s·ª≠a kh√°ch h√†ng (·∫®n ban ƒë·∫ßu) -->
  <div id="editCustomerForm" style="display: none;">
    <h3>S·ª≠a kh√°ch h√†ng</h3>
    <form th:action="@{/customers/edit}" method="post">
      <input type="hidden" id="editId" name="id">

      <label for="editName">T√™n kh√°ch h√†ng:</label>
      <input type="text" id="editName" name="name" required>

      <label for="editPhone">S·ªë ƒëi·ªán tho·∫°i:</label>
      <input type="text" id="editPhone" name="phone" required>

      <label for="editAddress">ƒê·ªãa ch·ªâ:</label>
      <input type="text" id="editAddress" name="address" required>

      <label for="editDebtBalance">C√¥ng n·ª£:</label>
      <input type="number" id="editDebtBalance" name="debtBalance" step="0.01" required>

      <button type="submit" class="btn">L∆∞u thay ƒë·ªïi</button>
      <button type="button" class="btn cancel" onclick="closeEditForm()">H·ªßy</button>
    </form>
  </div>

</div>

</body>
</html>
